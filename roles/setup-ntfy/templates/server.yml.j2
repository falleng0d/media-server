# ntfy server configuration
# Generated by Ansible - DO NOT EDIT MANUALLY

# Basic server configuration
base-url: "{{ ntfy_base_url }}"
listen-http: "{{ ntfy_listen_http }}"

# Cache configuration
{% if ntfy_cache_file %}
cache-file: "{{ ntfy_cache_file }}"
{% endif %}
cache-duration: "{{ ntfy_cache_duration }}"
{% if ntfy_cache_startup_queries %}
cache-startup-queries: "{{ ntfy_cache_startup_queries }}"
{% endif %}
{% if ntfy_cache_batch_size > 0 %}
cache-batch-size: {{ ntfy_cache_batch_size }}
{% endif %}
{% if ntfy_cache_batch_timeout != "0s" %}
cache-batch-timeout: "{{ ntfy_cache_batch_timeout }}"
{% endif %}

# Authentication configuration
{% if ntfy_auth_file %}
auth-file: "{{ ntfy_auth_file }}"
{% endif %}
auth-default-access: "{{ ntfy_auth_default_access }}"
enable-login: {{ ntfy_enable_login | lower }}
enable-signup: {{ ntfy_enable_signup | lower }}
enable-reservations: {{ ntfy_enable_reservations | lower }}

# Attachment configuration
{% if ntfy_attachment_cache_dir %}
attachment-cache-dir: "{{ ntfy_attachment_cache_dir }}"
{% endif %}
attachment-total-size-limit: "{{ ntfy_attachment_total_size_limit }}"
attachment-file-size-limit: "{{ ntfy_attachment_file_size_limit }}"
attachment-expiry-duration: "{{ ntfy_attachment_expiry_duration }}"

# Rate limiting
visitor-request-limit-burst: {{ ntfy_visitor_request_limit_burst }}
visitor-request-limit-replenish: "{{ ntfy_visitor_request_limit_replenish }}"
visitor-attachment-total-size-limit: "{{ ntfy_visitor_attachment_total_size_limit }}"
visitor-attachment-daily-bandwidth-limit: "{{ ntfy_visitor_attachment_daily_bandwidth_limit }}"
visitor-subscription-limit: {{ ntfy_visitor_subscription_limit }}
{% if ntfy_visitor_message_daily_limit > 0 %}
visitor-message-daily-limit: {{ ntfy_visitor_message_daily_limit }}
{% endif %}

# Proxy settings
{% if ntfy_behind_proxy %}
behind-proxy: {{ ntfy_behind_proxy | lower }}
{% endif %}
{% if ntfy_proxy_forwarded_header and ntfy_proxy_forwarded_header != "X-Forwarded-For" %}
proxy-forwarded-header: "{{ ntfy_proxy_forwarded_header }}"
{% endif %}
{% if ntfy_proxy_trusted_hosts %}
proxy-trusted-hosts: "{{ ntfy_proxy_trusted_hosts }}"
{% endif %}

# SMTP configuration (optional)
{% if ntfy_smtp_sender_addr %}
smtp-sender-addr: "{{ ntfy_smtp_sender_addr }}"
{% endif %}
{% if ntfy_smtp_sender_user %}
smtp-sender-user: "{{ ntfy_smtp_sender_user }}"
{% endif %}
{% if ntfy_smtp_sender_pass %}
smtp-sender-pass: "{{ ntfy_smtp_sender_pass }}"
{% endif %}
{% if ntfy_smtp_sender_from %}
smtp-sender-from: "{{ ntfy_smtp_sender_from }}"
{% endif %}

# Web Push configuration (optional)
{% if ntfy_web_push_public_key %}
web-push-public-key: "{{ ntfy_web_push_public_key }}"
{% endif %}
{% if ntfy_web_push_private_key %}
web-push-private-key: "{{ ntfy_web_push_private_key }}"
{% endif %}
{% if ntfy_web_push_file %}
web-push-file: "{{ ntfy_web_push_file }}"
{% endif %}
{% if ntfy_web_push_email_address %}
web-push-email-address: "{{ ntfy_web_push_email_address }}"
{% endif %}

# Upstream configuration
{% if ntfy_upstream_base_url and ntfy_upstream_base_url != "https://ntfy.sh" %}
upstream-base-url: "{{ ntfy_upstream_base_url }}"
{% endif %}
{% if ntfy_upstream_access_token %}
upstream-access-token: "{{ ntfy_upstream_access_token }}"
{% endif %}

# Message and topic limits
message-size-limit: "{{ ntfy_message_size_limit }}"
message-delay-limit: "{{ ntfy_message_delay_limit }}"
global-topic-limit: {{ ntfy_global_topic_limit }}

# Intervals
keepalive-interval: "{{ ntfy_keepalive_interval }}"
manager-interval: "{{ ntfy_manager_interval }}"

# Logging
log-level: "{{ ntfy_log_level }}"
log-format: "{{ ntfy_log_format }}"
{% if ntfy_log_file %}
log-file: "{{ ntfy_log_file }}"
{% endif %}
